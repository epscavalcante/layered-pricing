DROP SCHEMA IF EXISTS app;
CREATE DATABASE IF NOT EXISTS app;
USE app;
SET character_set_client = utf8;
SET character_set_connection = utf8;
SET character_set_results = utf8;
SET collation_connection = utf8_general_ci;

CREATE TABLE app.layers (
    id VARCHAR(100) NOT NULL,
    layer_id VARCHAR(100) NULL DEFAULT NULL,
    code VARCHAR(100) NOT NULL,
    type VARCHAR(100) NOT NULL,
    discount_type VARCHAR(100) DEFAULT NULL,
    discount_value BIGINT UNSIGNED NULL DEFAULT NULL,
    description VARCHAR(100) DEFAULT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE app.products (
    id VARCHAR(100) NOT NULL,
    name VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE app.prices (
    id VARCHAR(100) NOT NULL,
    product_id VARCHAR(100) NOT NULL,
    layer_id VARCHAR(100) NOT NULL,
    value_cents BIGINT UNSIGNED NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- 1 Layer
INSERT INTO layers (id, code, description, type) VALUES
('01J8M5R4G2R7D6ZP8R1B7QH8YJ', 'DEFAULT_LAYER', 'Tabela base de exemplo', 'NORMAL');

-- 3 Produtos
INSERT INTO products (id, name) VALUES
('01J8M5R6T9Q9H8X7L2E9ZP4K8C', 'Produto A'),
('01J8M5R7B5P3F4M6Q8C9W1E2ZK', 'Produto B'),
('01J8M5R8L7D1V2K3N5P4F6Y9XJ', 'Produto C');

-- Pre√ßos para a Layer
INSERT INTO prices (id, product_id, layer_id, value_cents) VALUES
('01J8M5R9P8L2K3F4M7N1ZQ5H6X', '01J8M5R6T9Q9H8X7L2E9ZP4K8C', '01J8M5R4G2R7D6ZP8R1B7QH8YJ', 1000), -- Produto A = R$ 10,00
('01J8M5RAP3F4M6Q8C9W1E2ZK7L', '01J8M5R7B5P3F4M6Q8C9W1E2ZK', '01J8M5R4G2R7D6ZP8R1B7QH8YJ', 2500), -- Produto B = R$ 25,00
('01J8M5RBL7D1V2K3N5P4F6Y9XJ', '01J8M5R8L7D1V2K3N5P4F6Y9XJ', '01J8M5R4G2R7D6ZP8R1B7QH8YJ', 4500); -- Produto C = R$ 45,00